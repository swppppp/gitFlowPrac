<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title></title>
<script type="text/javascript">
window.onload = function() {
	document.getElementById("send").onclick=function(){
		var message = document.getElementById('message').value;
		sendServer(message);
		//appendMessage(message);
	}

}

function sendServer(message) {

	// 변수처리한 값을 서버로 보낼 xmlhttprequest객체 생성
	var request = new XMLHttpRequest();
	//alert(request);
	
	/* // 이 객체가 뭐 갖고있는지...forin문으로 확인
	for ( var name in request) {
		console.log(name + ": "+ request[name]);
	}
	*/
	
	// open메소드 인자(1: 방식, 2: url, 3: 동기(false), 비동기(true))
	var url = "server.jsp?message="+message;
	request.open("get", url, true); // get방식 queryString을 통해서 값을 서버로 보냄
	// 수신 이벤트 리스너를 보내기 전에 설정해줌(이 객체의 status가 바뀌어요 그때마다 이벤트처리)
	request.onreadystatechange = function() {
		if(request.readyState == 4){
			if(request.status == 200){
				appendMessage(request.responseText);
			}else if(request.status == 400){
				alert("400Error: 잘못된 요청입니다.");
			}else if(request.status == 404){
				alert("404Error: 요청 페이지를 찾을 수 없습니다.");
			}else if(request.status == 500){
				alert("500Error: 서버가 잘못되었다.");
			}
		}else{
			console.log("서버로부터 데이터 수신중");
		}
	}
	request.send();
	//alert("데이터 수신했습니다..!!!")
}

function appendMessage(message) {
	var messageBox = document.getElementById('messageBox');
	if(messageBox){
		messageBox.innerText = message;
	}
}
</script>
</head>
<body>

  <input type="text" name="message" id="message" size="20">
  <input type="button" id="send" value="전송">
  <span id="messageBox"></span>

</body>
</html>